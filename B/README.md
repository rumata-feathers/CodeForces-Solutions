# B. Splay-tree

## url: https://codeforces.com/group/PVbQ8eK2T4/contest/357142/problem/B

### B. Splay-ะดะตัะตะฒะพ

ะพะณัะฐะฝะธัะตะฝะธะต ะฟะพ ะฒัะตะผะตะฝะธ ะฝะฐ ัะตัั3 ัะตะบัะฝะดั

ะพะณัะฐะฝะธัะตะฝะธะต ะฟะพ ะฟะฐะผััะธ ะฝะฐ ัะตัั256 ะผะตะณะฐะฑะฐะนั

ะฒะฒะพะดััะฐะฝะดะฐััะฝัะน ะฒะฒะพะด

ะฒัะฒะพะดััะฐะฝะดะฐััะฝัะน ะฒัะฒะพะด


ะะตะฐะปะธะทัะนัะต splay-ะดะตัะตะฒะพ, ะบะพัะพัะพะต ะฟะพะดะดะตัะถะธะฒะฐะตั ะผะฝะพะถะตััะฒะพ ๐ ัะตะปัั ัะธัะตะป, ะฒ ะบะพัะพัะพะผ ัะฐะทัะตัะฐะตััั ะฟัะพะธะทะฒะพะดะธัั ัะปะตะดัััะธะต ะพะฟะตัะฐัะธะธ:

- ๐๐๐(๐) โ ะดะพะฑะฐะฒะธัั ะฒ ะผะฝะพะถะตััะฒะพ ๐ ัะธัะปะพ ๐ (ะตัะปะธ ะพะฝ ัะฐะผ ัะถะต ะตััั, ัะพ ะผะฝะพะถะตััะฒะพ ะฝะต ะผะตะฝัะตััั);
- ๐๐ข๐(๐,๐) โ ะฒัะฒะตััะธ ััะผะผั ะฒัะตั ัะปะตะผะตะฝัะพะฒ ๐ฅ ะธะท ๐, ะบะพัะพััะต ัะดะพะฒะปะตัะฒะพัััั ะฝะตัะฐะฒะตะฝััะฒั ๐โค๐ฅโค๐.


ะะตัะตะฝะธั, ะฝะต ะธัะฟะพะปัะทัััะธะต splay-ะดะตัะตะฒัั, ะฑัะดัั ะธะณะฝะพัะธัะพะฒะฐัััั.


ะะตัะตะฝะธั, ะฝะต ะธัะฟะพะปัะทัััะธะต ะพะฟะตัะฐัะธะธ split ะธ merge, ะฑัะดัั ะพัะตะฝะธะฒะฐัััั ะฒ 2 ะฑะฐะปะปะฐ. ะะตัะตะฝะธั, ะธัะฟะพะปัะทัััะธะต ะพะฟะตัะฐัะธะธ split ะธ merge, ะพัะตะฝะธะฒะฐัััั ะฒ 3 ะฑะฐะปะปะฐ.



ะัะพะดะฝัะต ะดะฐะฝะฝัะต

ะััะพะดะฝะพ ะผะฝะพะถะตััะฒะพ ๐ ะฟัััะพ. ะะตัะฒะฐั ัััะพะบะฐ ะฒัะพะดะฝะพะณะพ ัะฐะนะปะฐ ัะพะดะตัะถะธั ๐ โ ะบะพะปะธัะตััะฒะพ ะพะฟะตัะฐัะธะน (1โค๐โค300000). ะกะปะตะดัััะธะต ๐ ัััะพะบ ัะพะดะตัะถะฐั ะพะฟะตัะฐัะธะธ. ะะฐะถะดะฐั ะพะฟะตัะฐัะธั ะธะผะตะตั ะฒะธะด ะปะธะฑะพ ยซ+ ๐ยป, ะปะธะฑะพ ยซ? ๐ ๐ยป. ะะฟะตัะฐัะธั ยซ? ๐ ๐ยป ะทะฐะดะฐะตั ะทะฐะฟัะพั ๐๐ข๐(๐,๐).


ะัะปะธ ะพะฟะตัะฐัะธั ยซ+ ๐ยป ะธะดะตั ะฒะพ ะฒัะพะดะฝะพะผ ัะฐะนะปะต ะฒ ะฝะฐัะฐะปะต ะธะปะธ ะฟะพัะปะต ะดััะณะพะน ะพะฟะตัะฐัะธะธ ยซ+ยป, ัะพ ะพะฝะฐ ะทะฐะดะฐะตั ะพะฟะตัะฐัะธั ๐๐๐(๐). ะัะปะธ ะถะต ะพะฝะฐ ะธะดะตั ะฟะพัะปะต ะทะฐะฟัะพัะฐ ยซ?ยป, ะธ ัะตะทัะปััะฐั ััะพะณะพ ะทะฐะฟัะพัะฐ ะฑัะป ๐ฆ, ัะพ ะฒัะฟะพะปะฝัะตััั ะพะฟะตัะฐัะธั ๐๐๐((๐+๐ฆ)mod109).


ะะพ ะฒัะตั ะทะฐะฟัะพัะฐั ะธ ะพะฟะตัะฐัะธัั ะดะพะฑะฐะฒะปะตะฝะธั ะฟะฐัะฐะผะตััั ะปะตะถะฐั ะฒ ะธะฝัะตัะฒะฐะปะต ะพั 0 ะดะพ 109.


ะััะพะดะฝัะต ะดะฐะฝะฝัะต

ะะปั ะบะฐะถะดะพะณะพ ะทะฐะฟัะพัะฐ ะฒัะฒะตะดะธัะต ะพะดะฝะพ ัะธัะปะพ โ ะพัะฒะตั ะฝะฐ ะทะฐะฟัะพั.
